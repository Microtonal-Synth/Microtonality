!function(){"use strict";var e,t,n,a={8105:function(e,t,n){var a=n(7294),s=n(745),i=n(9655),r=n(9250);function l(e){return a.createElement(i.OL,Object.assign({},e,{className:({isActive:e})=>"2xl:text-xl xl:text-lg lg:text-md md:text-sm sm:text-xs xs:text-xs font-agrandir-wide leading-relaxed \n        inline-block mr-4 px-5 whitespace-nowrap uppercase \n        "+(e?"text-gold underline":"text-white hover:underlin")}),e.children)}var c=n(4398);function o(e){let[t,n]=(0,a.useState)(e.value),[s,i]=(0,a.useState)(e.value.toFixed(2).toString()),[r,l]=(0,a.useState)(!1);const c=(0,a.useRef)(null);(0,a.useEffect)((()=>{r||e.value===t||g()}),[r]),(0,a.useEffect)((()=>{n(e.value)}),[e.value]),(0,a.useEffect)((()=>{o()}),[t]);const o=()=>{i(t.toFixed(2).toString())},u=t=>{const{movementX:a,movementY:s}=t;n((t=>d(a/(100/e.max)+s/(100/e.max)*-1+t)))},m=()=>{document.removeEventListener("mousemove",u),document.removeEventListener("mouseup",m),l(!1)},d=t=>Math.min(e.max,Math.max(e.min,t)),g=()=>{e.onChange(t)};return a.createElement("div",{className:`flex flex-col min-h-full w-full justify-around items-center bg-neutral-700 rounded-xl ${e.className}`},a.createElement("div",{className:"flex w-[7rem] justify-center"},a.createElement("a",{className:"2xl:text-xl xl:text-lg md:text-sm sm:text-xs font-agrandir-wide uppercase px-5 py-3 rounded block leading-normal text-center text-white"},e.knobLabel)),a.createElement("div",{className:`aspect-square rounded-full ${e.small?"p-1":"p-2"} bg-gradient-to-b from-neutral-500 to-neutral-900 flex w-3/4 mb-1`,onMouseDown:e=>(e.preventDefault(),document.addEventListener("mousemove",u),document.addEventListener("mouseup",m),void l(!0))},a.createElement("div",{className:"w-full h-full rounded-full p-0.5 bg-gradient-to-b from-stone-700 to-neutral-800 flex-1"},a.createElement("div",{style:{transform:`rotate(${(t=>{const n=e.max-e.min;return(t-e.min)/n*(e.maxAngle-e.minAngle)+e.minAngle-180})(t)}deg)`},className:"w-full h-full flex items-start justify-center"},a.createElement("div",{className:(e.small?"w-2 h-2":"w-3.5 h-3.5")+" rounded-full bg-black"})))),a.createElement("input",{className:"text-center self-center w-3/4 text-sm settings-panel-input p-px",type:"number",ref:c,value:s,onChange:e=>{i(e.target.value)},onBlur:()=>(()=>{let t=d(parseFloat(s));isNaN(t)||t===e.value?o():(n(t),e.onChange(t))})(),onKeyDown:e=>{"Enter"===e.key&&c.current.blur()},min:0,max:1,step:.01}))}o.defaultProps={min:0,max:1,value:0,minAngle:30,maxAngle:330,className:"w-96",knobLabel:"Label",small:!1};var u=n(8721);class m{constructor(e,t,n=""){this.id=(0,u.Z)(),this.num=e,this.multiplier=t,this.comments=n}exportScala(){return""===this.comments?this.num:this.num+" "+this.comments}abstractEquals(e){return 1===this.multiplier&&this.multiplier===e.multiplier&&this.comments===e.comments||this.num===e.num&&this.comments===e.comments}equals(e){return this.id===e.id}}class d extends m{constructor(e,t="",n=""){let a;"string"==typeof e?(a=e,e=parseFloat(e)):a=e.toString(),a.includes(".")||(a+=".0"),super(a,d.centsToMultiplier(e),t),this.cents=e,this.prevRatio=n}static centsToMultiplier(e){return Math.pow(2,e/1200)}}const g=new d(0);class p extends m{constructor(e,t=""){e.includes("/")||(e+="/1"),super(e,p.ratioToMultiplier(e),t),this.ratio=e}static ratioToMultiplier(e){let t=new RegExp(/(\d+)\/(\d+)/).exec(e);return parseInt(t[1])/(parseInt(t[2])||1)}}const f=new p("1/1"),b=new p("2/1"),h={notes:[f],title:"",description:"",octaveNote:b};function E(e,t){if(e.title!==t.title||e.description!==t.description||e.notes.length!==t.notes.length||!e.octaveNote.abstractEquals(t.octaveNote))return!1;for(let n=0;n<e.notes.length;n++)if(!e.notes.at(n).abstractEquals(t.notes.at(n)))return!1;return!0}function v(e,t){return e.notes[t%e.notes.length]}var y;function O(e){var t;let n=h,a=[],s=null,i=e.split("\n"),r=1,l=i.at(0).trim();l.startsWith("!")&&(n=Object.assign(Object.assign({},n),{title:x(l)}),i.shift(),r++);let c=-1,o=y.DESCRIPTION;for(let e of i)if(e=e.trim(),r++,!e.startsWith("!"))if(o===y.DESCRIPTION)n=Object.assign(Object.assign({},n),{description:e}),o=y.KEYS_PER_OCTAVE;else if(o===y.KEYS_PER_OCTAVE){if(c=parseInt(e),isNaN(c))throw new Error(w(r,e));o=y.PITCH_VALUES}else if(o===y.PITCH_VALUES){let t=N(e,r);if(!t)throw new Error(C(e,r));if(a.length===c-1){s=t;break}a.push(t)}if(a.length<c-1||!s)throw new Error(T(c,a.length));return a.unshift((null!==(t=a.at(0))&&void 0!==t?t:s)instanceof p?f:g),n=Object.assign(Object.assign({},n),{notes:a,octaveNote:s}),n}function x(e){let t=e;t=t.substring(1),t=t.trim();let n=t.split(" ");return t=n.at(0),t.endsWith(".scl")&&(t=t.substring(0,t.length-4)),t}function N(e,t){let n="",a=null;e.startsWith("-")&&(n+="-",a=d,e=e.substring(1));let s=0;for(;s<e.length;s++){let i=e.charAt(s);if(isNaN(parseInt(i)))if("."!==i||n.includes(".")){if("/"!==i||n.includes("/")){if(0===n.length)throw new Error(j(e,t));break}a=p,n+=i}else a=d,n+=i;else n+=i}return null!=a||(a=p),n=k(a===p,n),new a(n,e.substring(s).trim())}function k(e,t){return e?function(e){if(""===e||"/"===e)return f.num;e.startsWith("-")&&(e=e.substring(1));e.startsWith("/")&&(e="1"+e);e.endsWith("/")?e+="1":e.includes("/")||(e+="/1");let t=parseInt(e.slice(0,e.indexOf("/"))),n=parseInt(e.slice(e.indexOf("/")+1));0===n&&(n=1);return t+"/"+n}(t):function(e){if(""===e||"-"===e||"."===e)return g.num;(e=parseFloat(e).toString()).includes(".")||(e+=".0");return e}(t)}!function(e){e[e.DESCRIPTION=0]="DESCRIPTION",e[e.KEYS_PER_OCTAVE=1]="KEYS_PER_OCTAVE",e[e.PITCH_VALUES=2]="PITCH_VALUES"}(y||(y={}));const w=(e,t)=>`The number of pitch values in your Scala file must be an integer.\n        \n         Check line ${e}: "${t}"\n        `,T=(e,t)=>{let n=e-t;return`The Scala file needs ${e} pitch values but only has ${t}.\n        \n         Please insert ${n} more pitch value${1===n?"":"s"} or adjust the scale's size.\n        `},C=(e,t)=>`Pitch value at line ${t} is incorrect: "${e}"\n        \n         Only cents (100.0), ratios (1/2), or integers (2 (shorthand for 2/1)) \n         are allowed, followed by an optional comment.\n        `,j=(e,t)=>`You cannot have comments before a pitch value.\n        \n         Check line ${t}: "${e}"\n        `;function S(e){let t,n=[],a=null;for(let t of e.notes)a=t.num.includes(".")?d:p,n.push(new a(t.num,t.comments));return a=e.octaveNote.num.includes(".")?d:p,t=new a(e.octaveNote.num,e.octaveNote.comments),{title:e.title,description:e.description,notes:n,octaveNote:t}}function R(e){let t=[];for(let n=0;n<e;n++)t.push(1200/e*n);return function(e,t="",n=""){let a=e.map((e=>new d(e)));return Object.assign(Object.assign({},h),{notes:a,title:t,description:n})}(t,`${e}-TET`,`A ${e}-tone equal tempered scale.`)}const A=[...(()=>{let e=[];for(let t=12;t<=32;t++)e.push(R(t));return e})()];var I=n(8865);const _=(e,t)=>{let n=((e,t)=>{let n=R(t).notes.map((e=>e.multiplier)),a=e.notes.map((e=>e.multiplier)),s=[];if(t>e.notes.length){let e=n;n=a,a=e}let i=a.map(((e,t)=>({multiplier:e,originalIndex:t})));for(let e of n){if(0===i.length)break;i=i.sort(((t,n)=>Math.abs(e-t.multiplier)-Math.abs(e-n.multiplier))),s.push(i[0].originalIndex),i.splice(0,1)}let r={};if(t>e.notes.length)for(let e in s)r[s[e]]=Number(e);else for(let e in s)r[e]=s[e];return r})(e,t),a=Object.keys(n).length,s={};for(let i=0;i<t;i++)s[n[i%a]+Math.floor(i/a)*e.notes.length]=i;return n},L=(e,t)=>I.WX.create({firstNote:e,lastNote:e+t,keyboardConfig:I.WX.HOME_ROW}),D=(e,t)=>e instanceof p&&t instanceof p?F(e,t):V(e,t),M=e=>e instanceof p?new d(P(e),e.comments,e.num):e instanceof d?new p(G(e),e.comments):void 0,P=e=>function(e){if(e<=1)return"0.0";let t=(1200*Math.log2(e)).toString();t.includes(".")||(t+=".0");return t}(e.multiplier),G=e=>e.prevRatio?e.prevRatio:"1/1";const F=(e,t)=>{let n,a=new RegExp(/(\d+)\/(\d+)/),s=a.exec(e.num),i=a.exec(t.num),r=parseInt(s[1]),l=parseInt(s[2]),c=parseInt(i[1]),o=parseInt(i[2]),u=U(l,o);return l!==u&&(r*=u),o!==u&&(c*=u),n=r+c,u*=2,new p(`${n}/${u}`)},V=(e,t)=>{let n,a;return e instanceof d&&t instanceof d?n=new d((e.cents+t.cents)/2):e instanceof d&&t instanceof p?(a=new d(P(t)),n=new d((e.cents+a.cents)/2)):e instanceof p&&t instanceof d&&(a=new d(P(e)),n=new d((a.cents+t.cents)/2)),n},U=(e,t)=>Math.abs(e*t/K(e,t)),K=(e,t)=>{for(e=Math.abs(e),t=Math.abs(t);t;){let n=t;t=e%t,e=n}return e},B={pitchRatio:1,localGain:.5,waveType:"sine"},$={gain:.45,pitchBend:0,attack:.1,decay:.1,sustain:.5,release:.1,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1}),Object.assign(Object.assign({},B),{pitchRatio:2}),Object.assign(Object.assign({},B),{pitchRatio:3}),Object.assign(Object.assign({},B),{pitchRatio:4}),Object.assign(Object.assign({},B),{pitchRatio:5}),Object.assign(Object.assign({},B),{pitchRatio:6}),Object.assign(Object.assign({},B),{pitchRatio:7})]},q={gain:.45,pitchBend:0,attack:.01,decay:.1,sustain:.4,release:.3,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1,waveType:"triangle",localGain:.67}),Object.assign(Object.assign({},B),{pitchRatio:2,waveType:"triangle",localGain:.32}),Object.assign(Object.assign({},B),{pitchRatio:3,waveType:"sine",localGain:.18}),Object.assign(Object.assign({},B),{pitchRatio:4,waveType:"sine",localGain:.08}),Object.assign(Object.assign({},B),{pitchRatio:5,waveType:"triangle",localGain:.04}),Object.assign(Object.assign({},B),{pitchRatio:6,waveType:"sine",localGain:.02}),Object.assign(Object.assign({},B),{pitchRatio:7,waveType:"sawtooth",localGain:.01})]},Y={gain:.45,pitchBend:0,attack:.2,decay:1,sustain:1,release:.2,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1,waveType:"triangle",localGain:.83}),Object.assign(Object.assign({},B),{pitchRatio:2,waveType:"sine",localGain:.15}),Object.assign(Object.assign({},B),{pitchRatio:3,waveType:"triangle",localGain:.17}),Object.assign(Object.assign({},B),{pitchRatio:4,waveType:"sine",localGain:.1}),Object.assign(Object.assign({},B),{pitchRatio:5,waveType:"triangle",localGain:.01}),Object.assign(Object.assign({},B),{pitchRatio:6,waveType:"sine",localGain:.06}),Object.assign(Object.assign({},B),{pitchRatio:7,localGain:0})]},W={gain:.45,pitchBend:0,attack:.3,decay:1,sustain:.3,release:1,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1}),Object.assign(Object.assign({},B),{pitchRatio:2}),Object.assign(Object.assign({},B),{pitchRatio:3}),Object.assign(Object.assign({},B),{pitchRatio:4}),Object.assign(Object.assign({},B),{pitchRatio:5}),Object.assign(Object.assign({},B),{pitchRatio:6}),Object.assign(Object.assign({},B),{pitchRatio:7})]},z={gain:.45,pitchBend:0,attack:.08,decay:.1,sustain:.4,release:.3,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1,waveType:"sine",localGain:.5}),Object.assign(Object.assign({},B),{pitchRatio:2,waveType:"triangle",localGain:.13}),Object.assign(Object.assign({},B),{pitchRatio:3,waveType:"sine",localGain:.5}),Object.assign(Object.assign({},B),{pitchRatio:4,waveType:"triangle",localGain:.15}),Object.assign(Object.assign({},B),{pitchRatio:5,waveType:"sine",localGain:.5}),Object.assign(Object.assign({},B),{pitchRatio:6,waveType:"triangle",localGain:.17}),Object.assign(Object.assign({},B),{pitchRatio:7,waveType:"sine",localGain:.5})]},H={gain:.45,pitchBend:0,attack:1,decay:1,sustain:1,release:1,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1}),Object.assign(Object.assign({},B),{pitchRatio:2}),Object.assign(Object.assign({},B),{pitchRatio:3}),Object.assign(Object.assign({},B),{pitchRatio:4}),Object.assign(Object.assign({},B),{pitchRatio:5}),Object.assign(Object.assign({},B),{pitchRatio:6}),Object.assign(Object.assign({},B),{pitchRatio:7})]},J={gain:.45,pitchBend:0,attack:.1,decay:.25,sustain:.5,release:.27,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1,waveType:"sine",localGain:.67}),Object.assign(Object.assign({},B),{pitchRatio:2,waveType:"sine",localGain:.82}),Object.assign(Object.assign({},B),{pitchRatio:3,waveType:"sine",localGain:.69}),Object.assign(Object.assign({},B),{pitchRatio:4,waveType:"sine",localGain:.5}),Object.assign(Object.assign({},B),{pitchRatio:5,waveType:"sine",localGain:.27}),Object.assign(Object.assign({},B),{pitchRatio:6,waveType:"sine",localGain:.12}),Object.assign(Object.assign({},B),{pitchRatio:7,waveType:"sawtooth",localGain:.09})]},Z={gain:.45,pitchBend:0,attack:1,decay:1,sustain:1,release:1,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1}),Object.assign(Object.assign({},B),{pitchRatio:2}),Object.assign(Object.assign({},B),{pitchRatio:3}),Object.assign(Object.assign({},B),{pitchRatio:4}),Object.assign(Object.assign({},B),{pitchRatio:5}),Object.assign(Object.assign({},B),{pitchRatio:6}),Object.assign(Object.assign({},B),{pitchRatio:7})]},Q={gain:.45,pitchBend:0,attack:1,decay:1,sustain:1,release:1,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1}),Object.assign(Object.assign({},B),{pitchRatio:2}),Object.assign(Object.assign({},B),{pitchRatio:3}),Object.assign(Object.assign({},B),{pitchRatio:4}),Object.assign(Object.assign({},B),{pitchRatio:5}),Object.assign(Object.assign({},B),{pitchRatio:6}),Object.assign(Object.assign({},B),{pitchRatio:7})]},X={gain:.45,pitchBend:0,attack:.13,decay:.14,sustain:.31,release:.43,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1,waveType:"sawtooth",localGain:1}),Object.assign(Object.assign({},B),{pitchRatio:2,waveType:"triangle",localGain:.75}),Object.assign(Object.assign({},B),{pitchRatio:3,waveType:"triangle",localGain:.3}),Object.assign(Object.assign({},B),{pitchRatio:4,waveType:"sine",localGain:.37}),Object.assign(Object.assign({},B),{pitchRatio:5,waveType:"sine",localGain:.43}),Object.assign(Object.assign({},B),{pitchRatio:6,waveType:"sine",localGain:.46}),Object.assign(Object.assign({},B),{pitchRatio:7,waveType:"sine",localGain:.08})]},ee={gain:.45,pitchBend:0,attack:.43,decay:1,sustain:1,release:.19,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1,waveType:"square",localGain:.45}),Object.assign(Object.assign({},B),{pitchRatio:2,waveType:"sine",localGain:.5}),Object.assign(Object.assign({},B),{pitchRatio:3,waveType:"square",localGain:.42}),Object.assign(Object.assign({},B),{pitchRatio:4,waveType:"sawtooth",localGain:.5}),Object.assign(Object.assign({},B),{pitchRatio:5,waveType:"sine",localGain:.43}),Object.assign(Object.assign({},B),{pitchRatio:6,waveType:"sawtooth",localGain:.34}),Object.assign(Object.assign({},B),{pitchRatio:7,waveType:"sine",localGain:.47})]},te={gain:.45,pitchBend:0,attack:1,decay:1,sustain:1,release:1,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1}),Object.assign(Object.assign({},B),{pitchRatio:2}),Object.assign(Object.assign({},B),{pitchRatio:3}),Object.assign(Object.assign({},B),{pitchRatio:4}),Object.assign(Object.assign({},B),{pitchRatio:5}),Object.assign(Object.assign({},B),{pitchRatio:6}),Object.assign(Object.assign({},B),{pitchRatio:7})]};var ne;!function(e){e[e.UNDO_CONFIG=0]="UNDO_CONFIG",e[e.REDO_CONFIG=1]="REDO_CONFIG",e[e.SET_CONFIG=2]="SET_CONFIG",e[e.SET_SCALE=3]="SET_SCALE",e[e.SET_PRESET=4]="SET_PRESET",e[e.ADD_NOTE=5]="ADD_NOTE",e[e.EDIT_NOTE=6]="EDIT_NOTE",e[e.CONVERT_NOTE=7]="CONVERT_NOTE",e[e.DELETE_NOTE=8]="DELETE_NOTE",e[e.EDIT_OCTAVE_NOTE=9]="EDIT_OCTAVE_NOTE",e[e.CONVERT_OCTAVE_NOTE=10]="CONVERT_OCTAVE_NOTE",e[e.SET_TUNING_FREQUENCY=11]="SET_TUNING_FREQUENCY",e[e.SET_OSCILLATOR=12]="SET_OSCILLATOR",e[e.SET_ATTACK=13]="SET_ATTACK",e[e.SET_DECAY=14]="SET_DECAY",e[e.SET_SUSTAIN=15]="SET_SUSTAIN",e[e.SET_RELEASE=16]="SET_RELEASE",e[e.SET_MASTER_GAIN=17]="SET_MASTER_GAIN",e[e.UNSET_KEYBIND=18]="UNSET_KEYBIND",e[e.SET_KEYBIND=19]="SET_KEYBIND"}(ne||(ne={}));const ae=(e,t)=>{console.log(Object.assign(Object.assign({},t),{actionString:ne[t.type]}));let n,a=Object.assign({},e);t.type===ne.UNDO_CONFIG?0!==a.previous.length&&(a.next.unshift(a.current),a.current=a.previous.pop()):t.type===ne.REDO_CONFIG&&0!==a.next.length&&(a.previous.push(a.current),a.current=a.next.shift());let s=a.current;if(t.type===ne.SET_CONFIG)n=Object.assign(Object.assign({},t.config),{scaleConfig:Object.assign(Object.assign({},t.config.scaleConfig),{scale:S(t.config.scaleConfig.scale)})});else if(t.type===ne.SET_SCALE)n={scaleConfig:{scale:t.scale}},n.keyMapping=_(n.scaleConfig.scale,a.current.scaleConfig.keysPerOctave);else if(t.type===ne.ADD_NOTE||t.type===ne.DELETE_NOTE||t.type===ne.EDIT_NOTE||t.type===ne.CONVERT_NOTE){let i=[...s.scaleConfig.scale.notes];if(t.type===ne.ADD_NOTE)i.push(t.note);else if(t.type===ne.DELETE_NOTE)i.splice(t.noteIndex,1);else if(t.type===ne.EDIT_NOTE||t.type===ne.CONVERT_NOTE){let e;if(t.type===ne.EDIT_NOTE)e=N(`${t.noteValue} ${i[t.noteIndex].comments}`);else if(t.type===ne.CONVERT_NOTE){let n=i.at(t.noteIndex);e=M(n)}i.splice(t.noteIndex,1,e)}n={scaleConfig:{scale:{notes:i}}},n.scaleConfig.scale.notes.length!==e.current.scaleConfig.scale.notes.length&&(n.keyMapping=_(n.scaleConfig.scale,a.current.scaleConfig.keysPerOctave))}else if(t.type===ne.EDIT_OCTAVE_NOTE||t.type===ne.CONVERT_OCTAVE_NOTE){let e,a=s.scaleConfig.scale.octaveNote;switch(t.type){case ne.EDIT_OCTAVE_NOTE:e=N(`${t.noteValue} ${a.comments}`);break;case ne.CONVERT_OCTAVE_NOTE:e=M(a)}n={scaleConfig:{scale:{octaveNote:e}}}}else if(t.type===ne.SET_TUNING_FREQUENCY)n={scaleConfig:{tuningFrequency:t.tuningFrequency}};else if(t.type===ne.SET_OSCILLATOR){let e=[...s.synthConfig.oscillators];e.splice(t.oscIndex,1,t.osc),n={synthConfig:{oscillators:e}}}else if(t.type===ne.SET_ATTACK)n={synthConfig:{attack:t.attack}};else if(t.type===ne.SET_DECAY)n={synthConfig:{decay:t.decay}};else if(t.type===ne.SET_SUSTAIN)n={synthConfig:{sustain:t.sustain}};else if(t.type===ne.SET_RELEASE)n={synthConfig:{release:t.release}};else if(t.type===ne.SET_MASTER_GAIN)n={synthConfig:{gain:t.gain}};else if(t.type===ne.UNSET_KEYBIND)n={keyMapping:{[t.keyIndex]:null}};else if(t.type===ne.SET_KEYBIND)n={keyMapping:{[t.keyIndex]:t.scaleDegree}};else if(t.type===ne.SET_PRESET)switch(t.preset){case"Basic":n={synthConfig:$};break;case"Piano":n={synthConfig:q};break;case"Flute":n={synthConfig:Y};break;case"Oboe":n={synthConfig:W};break;case"Clarinet":n={synthConfig:z};break;case"Bassoon":n={synthConfig:H};break;case"Trumpet":n={synthConfig:J};break;case"French Horn":n={synthConfig:Z};break;case"Trombone":n={synthConfig:Q};break;case"Tuba":n={synthConfig:X};break;case"Violin":n={synthConfig:ee};break;case"Cello":n={synthConfig:te}}return null!==ie(s,n,!0)&&(a.previous.push(a.current),a.current=Object.assign(Object.assign({},ie(s,n)),{configId:(0,u.Z)()}),a.next=[]),a},se=Object.getPrototypeOf({}),ie=(e,t,n=!1)=>{let a=!1,s=e;for(let e in t)if(null!==t[e])if(Object.getPrototypeOf(t[e])===se){let i=ie(s[e],t[e]);null!==i&&(a=!0,n||(s=Object.assign(Object.assign({},s),{[e]:i})))}else s[e]!==t[e]&&(n||(s=Object.assign(Object.assign({},s),{[e]:t[e]})),a=!0);else s[e]!==t[e]&&(n||(s=Object.assign(Object.assign({},s),{[e]:t[e]})),a=!0);return a?s:null};var re=n(3302),le=n(7828),ce=n(1364);const oe={type:"tween",duration:0},ue={type:"spring",stiffness:200},me={initial:{opacity:0},enter:{opacity:1},exit:{opacity:0}},de={initial:{scale:0},enter:{scale:1}},ge={initial:{width:0},enter:{width:null}},pe={initial:{height:0},enter:{height:null}},fe={initial:{left:-window.innerWidth},enter:{left:null},exit:{left:-window.innerWidth}},be={initial:{top:-window.innerHeight},enter:{top:null},exit:{top:-window.innerHeight}};var he=n(5518);const Ee=()=>ve()&&ye(),ve=()=>he.nI,ye=()=>he.i7||he.mJ||he.vU||he.f0;function Oe(e){var t;const n=(0,re.J)()||!Ee()?me:e.animation;return a.createElement(le.M,null,(null===(t=e.visible)||void 0===t||t)&&a.createElement(ce.E.div,{className:e.className,ref:e.clickOutsideRef,initial:n.initial,animate:n.enter,transition:n.transition,exit:n.exit},e.children))}const xe="";function Ne(){let e=(0,a.useContext)(Re),t=Pe();const n=()=>{t(xe)};return a.createElement(Oe,{className:"absolute flex justify-center w-full p-12 z-10",animation:be,visible:e!==xe},a.createElement("div",{className:"inline-flex max-w-4xl max-h-96 bg-rederror dark:bg-black rounded-lg shadow-lg shadow-black"},a.createElement("strong",{className:"whitespace-pre-line text-xl px-4 py-3 overflow-y-scroll text-black dark:text-rederror font-agrandir font-black"},e),a.createElement("div",{className:"px-3.5 py-4 bg-neutral-200 rounded-r-lg cursor-pointer group hover:bg-bgdark dark:bg-bgdark dark:hover:bg-bglight",tabIndex:0,onClick:()=>n(),onKeyDown:e=>{var t;"Enter"!==(t=e).key&&" "!==t.key||(n(),t.preventDefault())},onMouseLeave:e=>e.currentTarget.blur()},a.createElement("svg",{className:"w-6 h-6 stroke-black group-hocus:stroke-neutral-200 dark:stroke-neutral-200 dark:group-hocus:stroke-black outline-0",xmlns:"http://www.w3.org/2000/svg",strokeWidth:"3",strokeLinecap:"round"},a.createElement("line",{x1:4,y1:18,x2:18,y2:4}),a.createElement("line",{x1:18,y1:18,x2:4,y2:4})))))}const ke={gain:.3,pitchBend:0,attack:.2,decay:.5,sustain:.4,release:.3,oscillators:[Object.assign(Object.assign({},B),{pitchRatio:1}),Object.assign(Object.assign({},B),{pitchRatio:2}),Object.assign(Object.assign({},B),{pitchRatio:3}),Object.assign(Object.assign({},B),{pitchRatio:4}),Object.assign(Object.assign({},B),{pitchRatio:5}),Object.assign(Object.assign({},B),{pitchRatio:6}),Object.assign(Object.assign({},B),{pitchRatio:7})]},we={keysPerOctave:12,tuningFrequency:261.6255653005986,rootKey:72,scale:A.at(0)},Te={title:"MicrotonalSynthConfig",keyMapping:_(we.scale,we.keysPerOctave),scaleConfig:we,synthConfig:ke},Ce=(e,t,n)=>{let a=Object.assign(Object.assign(Object.assign({},we),null==e?void 0:e.scaleConfig),n),s=Object.assign(Object.assign(Object.assign({},ke),null==e?void 0:e.synthConfig),t);return Object.assign(Object.assign(Object.assign({},Te),e),{scaleConfig:a,synthConfig:s})},je=(0,a.createContext)(null),Se=(0,a.createContext)(null),Re=(0,a.createContext)(null),Ae=(0,a.createContext)(null);function Ie(e){const[t,n]=(0,a.useReducer)(ae,{previous:[],current:Ce(),next:[]}),[s,i]=(0,a.useState)(ve()?ye()?xe:Fe():Ge());return a.createElement(je.Provider,{value:t},a.createElement(Se.Provider,{value:n},a.createElement(Re.Provider,{value:s},a.createElement(Ae.Provider,{value:i},e.children))))}function _e(){return(0,a.useContext)(je)}function Le(){return _e().current}function De(){return Le().scaleConfig.scale}function Me(){return(0,a.useContext)(Se)}function Pe(){return(0,a.useContext)(Ae)}const Ge=()=>"Your current device is not supported. \n        \n         It is recommended you use a desktop for the best experience.\n         \n         There may be unintended behavior and display issues on other devices.\n        ",Fe=()=>"Your current browser is not supported. \n        \n         It is recommended you use Chrome, Chromium, Firefox, or Opera for the best experience.\n         \n         There may be unintended behavior and display issues on other browsers.\n        ";function Ve(e){const t=Le(),n=Me();let[s,i]=(0,a.useState)(e.settings.localGain),[r,l]=(0,a.useState)(e.settings.localGain.toString());const u=(0,a.useRef)(null),m=["sine","square","triangle","sawtooth"];(0,a.useEffect)((()=>{i(e.settings.localGain)}),[t]),(0,a.useEffect)((()=>{l(s.toString())}),[s]);const d=()=>{let t=g(parseFloat(r));if(isNaN(t)||t===s)return void l(s.toString());let n=Object.assign(Object.assign({},e.settings),{localGain:t});p(n),u.current.focus(),u.current.setAttribute("type","text"),u.current.selectionStart=t.toString().length,u.current.selectionEnd=t.toString().length,u.current.setAttribute("type","number")},g=e=>Math.min(1,Math.max(0,e)),p=t=>{n({type:ne.SET_OSCILLATOR,osc:t,oscIndex:e.oscIndex})};return a.createElement("div",{className:"flex h-[95%] flex-col items-center justify-between mr-1"},a.createElement("select",{"data-te-select-init":!0,value:e.settings.waveType,className:"flex h-8 w-full pt-0.5 rounded-md text-center font-agrandir text-sm dark:bg-bgdark dark:text-gold",onChange:t=>(t=>{let n=t.currentTarget.value;if(!m.includes(n))return;let a=Object.assign(Object.assign({},e.settings),{waveType:n});p(a)})(t)},(()=>{let e=[];return m.forEach(((t,n)=>{e.push(a.createElement("option",{value:t,key:n},t.toUpperCase()))})),e})()),a.createElement(c.Range,{step:.01,min:0,max:1,values:[""===r?0:g(parseFloat(r))],onChange:e=>l(e[0].toString()),onFinalChange:()=>d(),direction:c.Direction.Up,renderTrack:({props:e,children:t})=>a.createElement("div",Object.assign({},e,{style:Object.assign(Object.assign({},e.style),{border:"1px solid",borderColor:"gray",borderRadius:"10px",height:"60%",width:"10%",backgroundColor:"#212121",marginTop:"10%",marginBottom:"20%"})}),t),renderThumb:({props:e})=>a.createElement("div",Object.assign({},e,{style:Object.assign(Object.assign({},e.style),{width:"1rem",height:"1rem",border:"1px-solid",backgroundColor:"white",borderRadius:"100%"})}))}),a.createElement("input",{className:"text-center self-center w-3/4 text-sm settings-panel-input p-px",type:"number",ref:u,value:r,onChange:e=>l(e.target.value),onBlur:()=>d(),onKeyDown:e=>(e=>{if("Enter"===e.key)return u.current.blur(),void d()})(e),min:0,max:1,step:.01}),a.createElement("div",{className:"h-[10vw] w-[3.5vw]"},a.createElement(o,{min:0,max:16,value:e.settings.pitchRatio,onChange:t=>(t=>{let n=Object.assign(Object.assign({},e.settings),{pitchRatio:t});p(n)})(t),knobLabel:"",className:"",small:!0})))}function Ue(){const e=Me(),[t,n]=(0,a.useState)("Custom");return a.createElement("div",{className:"flex flex-col m-2 font-agrandir text-black text-md",onChange:t=>{e({type:ne.SET_PRESET,preset:t.target.value})}},a.createElement("select",{className:"flex rounded-md py-1 justify-center items-center dark:bg-bgdark dark:text-gold"},a.createElement("option",null,"Custom"),a.createElement("option",null,"Basic"),a.createElement("option",null,"Piano"),a.createElement("option",null,"Flute"),a.createElement("option",null,"Clarinet"),a.createElement("option",null,"Trumpet"),a.createElement("option",null,"Tuba"),a.createElement("option",null,"Violin")))}function Ke(){const e=Le().synthConfig,t=Me();return a.createElement("div",{className:"flex h-full w-full border-gold border-t-2 border-l-2 rounded-tl-xl bg-bglight"},a.createElement("div",{className:"flex h-full p-4"},a.createElement("div",{className:"flex mx-2 ml-0"},a.createElement("div",{className:"flex"},a.createElement("div",null,a.createElement(o,{knobLabel:"Attack",value:e.attack,onChange:e=>(e=>{t({type:ne.SET_ATTACK,attack:e})})(e),className:"border-gold border-2"})),a.createElement("div",{className:"ml-2"},a.createElement(o,{knobLabel:"Decay",value:e.decay,onChange:e=>(e=>{t({type:ne.SET_DECAY,decay:e})})(e),className:"border-gold border-2"})),a.createElement("div",{className:"ml-2"},a.createElement(o,{knobLabel:"Sustain",value:e.sustain,onChange:e=>(e=>{t({type:ne.SET_SUSTAIN,sustain:e})})(e),className:"border-gold border-2"})),a.createElement("div",{className:"ml-2"},a.createElement(o,{knobLabel:"Release",value:e.release,onChange:e=>(e=>{t({type:ne.SET_RELEASE,release:e})})(e),className:"border-gold border-2"})))),a.createElement("div",{className:"flex flex-row mx-2 p-4 pt-6 bg-neutral-700 rounded-xl border-gold border-2"},(()=>{let t=[],n=e.oscillators;for(let s=0;s<n.length;s++)t.push(a.createElement(Ve,{key:s,oscIndex:s,settings:e.oscillators[s]}));return t})()),a.createElement("div",{className:"flex flex-col mx-2 mr-0"},a.createElement("div",{className:"border-gold border-2 rounded-t-xl font-agrandir-wide text-white text-center bg-neutral-700"},a.createElement("div",null,"INSTRUMENT "),a.createElement("div",null,"PRESETS")),a.createElement("div",{className:"flex flex-col bg-neutral-700 rounded-b-xl border-gold border-2 border-t-0 h-full w-40 overflow-auto"},a.createElement(Ue,null)))))}function Be(e){return a.createElement("div",{className:`${e.className} w-full mb-0.5 select-none font-agrandir-wide text-white dark:text-neutral-200 2xl:text-xl xl:text-lg lg:text-md md:text-sm sm:text-xs xs:text-xs`},e.text)}const $e=(0,a.createContext)(null),qe=(0,a.createContext)(null),Ye=(0,a.createContext)(null),We=(0,a.createContext)(null);var ze;!function(e){e[e.VISUAL=0]="VISUAL",e[e.SCALA=1]="SCALA"}(ze||(ze={}));const He=(0,a.createContext)(null),Je=(0,a.createContext)(null);function Ze(e){const t=Le(),n=()=>({title:t.title,description:t.description}),[s,i]=(0,a.useState)(n()),r=t.scaleConfig.scale,l=()=>({title:r.title,description:r.description}),[c,o]=(0,a.useState)(l()),[u,m]=(0,a.useState)(ze.VISUAL);return(0,a.useEffect)((()=>{t.title&&t.description&&t.title!==s.title&&t.description!==s.description&&i(n())}),[t.configId]),(0,a.useEffect)((()=>{r.title&&r.description&&r.title!==c.title&&r.description!==c.description&&o(l())}),[r.title,r.description]),a.createElement($e.Provider,{value:s},a.createElement(qe.Provider,{value:i},a.createElement(Ye.Provider,{value:c},a.createElement(We.Provider,{value:o},a.createElement(He.Provider,{value:u},a.createElement(Je.Provider,{value:m},e.children))))))}function Qe(){return(0,a.useContext)($e)}function Xe(){return(0,a.useContext)(qe)}function et(){return(0,a.useContext)(Ye)}function tt(){return(0,a.useContext)(We)}function nt(){return(0,a.useContext)(He)}var at;function st(e){const t=t=>{"Enter"!==t.key&&" "!==t.key||e.setCurrentTab(e.currentTab===at.BASIC?at.SCALE:at.BASIC)};return a.createElement("ul",{className:"flex flex-row text-center"},1===e.currentTab?a.createElement("li",{tabIndex:0,className:"settings-tab-inactive settings-tab-l",onClick:()=>e.setCurrentTab(0),onKeyDown:e=>t(e)},"BASIC"):a.createElement("li",{className:"settings-tab-active settings-tab-l"},"BASIC",a.createElement("div",{className:"settings-tab-hook-parent-l"},a.createElement("div",{className:"settings-tab-hook-l"}))),0===e.currentTab?a.createElement("li",{tabIndex:0,className:"settings-tab-inactive settings-tab-r",onClick:()=>e.setCurrentTab(1),onKeyDown:e=>t(e)},"SCALE"):a.createElement("li",{className:"settings-tab-active settings-tab-r"},"SCALE",a.createElement("div",{className:"settings-tab-hook-parent-r"},a.createElement("div",{className:"settings-tab-hook-r"}))))}function it(){const e=Le().scaleConfig.tuningFrequency,t=Me(),[n,s]=(0,a.useState)(e),i=t=>isNaN(t)?e:Math.max(0,t);return a.createElement("div",{className:"flex flex-col mb-4"},a.createElement(Be,{text:"BASE FREQUENCY"}),a.createElement("input",{className:"settings-panel-input text-lg",type:"number",value:n,onBlur:()=>(()=>{let a=i(n);a!==e?t({type:ne.SET_TUNING_FREQUENCY,tuningFrequency:a}):s(a)})(),onKeyDown:e=>{var t;"Enter"===(t=e).key&&t.currentTarget.blur()},onChange:e=>s(parseFloat(e.target.value))}))}function rt(e){return a.createElement("div",{className:"px-2 py-1 text-white dark:text-gold select-none font-agrandir-wide border border-gold rounded bg-bglight dark:bg-bgdark"},e.text)}function lt(){const e=De(),t=Me(),n=12,[s,i]=(0,a.useState)(12),r=(0,a.useRef)(null),[l,c]=(0,a.useState)(!1),[o,u]=(0,a.useState)({left:0}),m=(0,re.J)()||!Ee()?oe:ue,d=Object.assign(Object.assign({},me),{enter:Object.assign(Object.assign({},me.enter),o),transition:m});(0,a.useEffect)((()=>{let t=e.notes.length;t>=n&&E(e,A[t-n])&&(i(t),u(b(t-n)))}),[e]);const g=()=>{c(!0)},p=()=>{c(!1),f()},f=()=>{let a=A.at(s-n);E(a,e)||t({type:ne.SET_SCALE,scale:a})},b=e=>{let t=e/20,n=r.current.offsetWidth*t;return n-=e,{left:n}};return a.createElement("div",{className:"flex flex-col mb-4"},a.createElement(Oe,{animation:me},a.createElement(Be,{text:"EQUAL-TEMPERED SCALE GENERATOR"})),a.createElement(Oe,{className:"relative",animation:ge},a.createElement("input",{className:"appearance-none w-full h-2 accent-neutral-200 cursor-pointer rounded-lg bg-bgdark border border-neutral-500 outline-0",ref:r,type:"range",step:1,min:n,max:32,value:s,onMouseDown:()=>g(),onMouseUp:()=>p(),onFocus:()=>g(),onBlur:()=>p(),onChange:e=>(e=>{let t=Number(e.target.value);i(t),u(b(t-n))})(e),onKeyDown:e=>{var t;"Enter"===(t=e).key&&t.currentTarget.blur()}}),a.createElement(Oe,{className:"absolute -mx-2 -mt-14",visible:l,animation:d},a.createElement(rt,{text:s.toString()}))))}function ct(e){const t=(0,a.useRef)(null);return a.createElement("div",{className:"flex flex-col mb-1"},a.createElement("button",{className:"settings-panel-button",onClick:e=>(e.currentTarget.blur(),void t.current.click())},e.text),a.createElement("input",{className:"hidden",type:"file",ref:t,accept:e.accept,onChange:n=>{return a=n,e.uploadFile(a),void(t.current.value="");var a}}))}function ot(e){return a.createElement("button",{disabled:e.disabled,className:`${e.className} settings-panel-button`,onClick:e.onClick,onMouseOut:e=>e.currentTarget.blur()},e.text)}function ut(e,...t){const n=(0,a.useRef)(null),s=a=>{n.current&&!n.current.contains(a.target)&&e(...t)};return(0,a.useEffect)((()=>(document.addEventListener("mousedown",s,!0),()=>{document.removeEventListener("mousedown",s,!0)})),[]),n}function mt(e){return a.createElement("svg",{className:`${e.className} ${dt} cursor-pointer bg-gold hocus:stroke-gold hocus:bg-black outline-none`,xmlns:"http://www.w3.org/2000/svg",tabIndex:0,onClick:e.onClick,onKeyDown:t=>{"Enter"!==t.key&&" "!==t.key||(e.onClick(),t.preventDefault())}},a.createElement("line",{x1:4,y1:4,x2:8,y2:8,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("line",{x1:8,y1:4,x2:4,y2:8,strokeLinecap:"round",strokeLinejoin:"round"}))}!function(e){e[e.BASIC=0]="BASIC",e[e.SCALE=1]="SCALE"}(at||(at={}));const dt="absolute w-4 h-4 stroke-black stroke-2 border-2 border-black rounded-full";function gt(e){const t=Pe(),[n,s]=(0,a.useState)(e.filename),i=(0,a.useRef)(null),[r,l]=a.useState(null);a.useLayoutEffect((()=>{r&&i.current&&([i.current.selectionStart,i.current.selectionEnd]=r)}),[r]);const c=n=>{try{n.trim(),(e=>{if(new RegExp(/^(CON|PRN|AUX|NUL|LST|COM[0-9]|LPT[0-9])$/).test(e))throw new Error(pt(e))})(n),e.setFilename(n)}catch(e){t(e.message)}};return a.createElement("div",{className:e.className},a.createElement(Be,{text:e.title}),a.createElement("input",{className:"settings-panel-input w-full",tabIndex:0,value:n,ref:i,onChange:e=>(e=>{let t=e.target.value,n=[e.target.selectionStart,e.target.selectionEnd],a=new RegExp(/[A-z0-9]/),i=["-","_"," "],r="";for(let e of t)a.test(e)||i.includes(e)?r+=e:n=[n[0]-1,n[1]-1];l(n),s(r)})(e),onKeyDown:e=>{"Enter"===e.key&&i.current.blur()},onBlur:e=>c(e.target.value)}))}const pt=e=>`The synth config's filename '${e}' is a reserved filename. \n        \n         Please change the filename and try again.\n        `;function ft(e){const[t,n]=(0,a.useState)(e.description);return a.createElement("div",{className:e.className},a.createElement(Be,{text:e.title}),a.createElement("textarea",{className:"settings-panel-input w-full resize-none",key:e.description,value:t,onKeyDown:e=>{var t;"Enter"===(t=e).key&&t.currentTarget.blur()},onChange:e=>n(e.target.value.replace(/\n/g,"")),onBlur:t=>e.setDescription(t.target.value)}))}function bt(e){const t=Qe(),n=Xe(),s=ut(e.setVisible,!1);return a.createElement(Oe,{className:"absolute w-full p-1 bg-neutral-700 border-2 border-black rounded",clickOutsideRef:s,animation:fe,visible:e.visible},a.createElement(gt,{title:"Synth Name",filename:t.title,setFilename:e=>{n(Object.assign(Object.assign({},t),{title:e}))}}),a.createElement(ft,{className:"mt-1",title:"Synth Description",description:t.description,setDescription:e=>{n(Object.assign(Object.assign({},t),{description:e}))}}),a.createElement(mt,{className:"-top-1.5 -right-1.5",onClick:()=>{e.setVisible(!1)}}))}function ht(e){return a.createElement(Oe,{animation:de},a.createElement("div",{className:`${e.className} relative settings-panel-svg-button-parent group ${e.disabled?"pointer-events-none":""}`,tabIndex:0,onClick:()=>e.onClick(),onKeyDown:t=>{var n;"Enter"!==(n=t).key&&" "!==n.key||(e.onClick(),n.preventDefault())},onMouseLeave:e=>e.currentTarget.blur()},a.createElement("svg",{className:"settings-panel-svg-button",xmlns:"http://www.w3.org/2000/svg",strokeLinecap:"round",strokeLinejoin:"round"},vt(e.svg)),e.children))}var Et;!function(e){e[e.pencilSquare=0]="pencilSquare",e[e.listBullet=1]="listBullet",e[e.arrowDownTray=2]="arrowDownTray",e[e.cog6tooth=3]="cog6tooth",e[e.questionMarkCircle=4]="questionMarkCircle"}(Et||(Et={}));const vt=e=>{let t=[];switch(e){case Et.pencilSquare:t.push(yt("M16.862 4.487l1.687-1.688a1.875 1.875 0 112.652 2.652L10.582 16.07a4.5 4.5 0 01-1.897 1.13L6 18l.8-2.685a4.5 4.5 0 011.13-1.897l8.932-8.931zm0 0L19.5 7.125M18 14v4.75A2.25 2.25 0 0115.75 21H5.25A2.25 2.25 0 013 18.75V8.25A2.25 2.25 0 015.25 6H10"));break;case Et.listBullet:t.push(yt("M8.25 6.75h12M8.25 12h12m-12 5.25h12M3.75 6.75h.007v.008H3.75V6.75zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zM3.75 12h.007v.008H3.75V12zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0zm-.375 5.25h.007v.008H3.75v-.008zm.375 0a.375.375 0 11-.75 0 .375.375 0 01.75 0z"));break;case Et.arrowDownTray:t.push(yt("M3 16.5v2.25A2.25 2.25 0 005.25 21h13.5A2.25 2.25 0 0021 18.75V16.5M16.5 12L12 16.5m0 0L7.5 12m4.5 4.5V3"));break;case Et.cog6tooth:t.push(yt("M9.594 3.94c.09-.542.56-.94 1.11-.94h2.593c.55 0 1.02.398 1.11.94l.213 1.281c.063.374.313.686.645.87.074.04.147.083.22.127.324.196.72.257 1.075.124l1.217-.456a1.125 1.125 0 011.37.49l1.296 2.247a1.125 1.125 0 01-.26 1.431l-1.003.827c-.293.24-.438.613-.431.992a6.759 6.759 0 010 .255c-.007.378.138.75.43.99l1.005.828c.424.35.534.954.26 1.43l-1.298 2.247a1.125 1.125 0 01-1.369.491l-1.217-.456c-.355-.133-.75-.072-1.076.124a6.57 6.57 0 01-.22.128c-.331.183-.581.495-.644.869l-.213 1.28c-.09.543-.56.941-1.11.941h-2.594c-.55 0-1.02-.398-1.11-.94l-.213-1.281c-.062-.374-.312-.686-.644-.87a6.52 6.52 0 01-.22-.127c-.325-.196-.72-.257-1.076-.124l-1.217.456a1.125 1.125 0 01-1.369-.49l-1.297-2.247a1.125 1.125 0 01.26-1.431l1.004-.827c.292-.24.437-.613.43-.992a6.932 6.932 0 010-.255c.007-.378-.138-.75-.43-.99l-1.004-.828a1.125 1.125 0 01-.26-1.43l1.297-2.247a1.125 1.125 0 011.37-.491l1.216.456c.356.133.751.072 1.076-.124.072-.044.146-.087.22-.128.332-.183.582-.495.644-.869l.214-1.281z")),t.push(yt("M15 12a3 3 0 11-6 0 3 3 0 016 0z"));break;case Et.questionMarkCircle:t.push(yt("M9.879 7.519c1.171-1.025 3.071-1.025 4.242 0 1.172 1.025 1.172 2.687 0 3.712-.203.179-.43.326-.67.442-.745.361-1.45.999-1.45 1.827v.75M21 12a9 9 0 11-18 0 9 9 0 0118 0zm-9 5.25h.008v.008H12v-.008z"))}return t},yt=e=>a.createElement("path",{d:e,key:e});function Ot(){const[e,t]=(0,a.useState)(!1);return a.createElement(a.Fragment,null,a.createElement(ht,{svg:Et.cog6tooth,onClick:()=>t(!0)}),a.createElement(bt,{visible:e,setVisible:t}))}function xt(){const e=Le(),t=Me(),n=Pe(),s=Qe(),i=Xe();return a.createElement("div",{className:"flex flex-col mb-4"},a.createElement("div",{className:"flex justify-between relative"},a.createElement(Be,{text:"SYNTH FILES"}),a.createElement(Ot,null)),a.createElement(ct,{text:"UPLOAD SYNTH FILE",accept:".mConfig",uploadFile:e=>(e=>{let a,s=e.target.files[0],r=new FileReader,l="";r.onload=()=>{a=r.result,l=a instanceof ArrayBuffer?(new TextDecoder).decode(a):a;try{let e=JSON.parse(l),n=s.name.substring(0,s.name.length-8);t({type:ne.SET_CONFIG,config:Object.assign(Object.assign({},e),{title:n,configId:(0,u.Z)()})}),i({title:e.title,description:e.description})}catch(e){n(Nt(s.name))}},r.onerror=()=>{n(Nt(s.name))},r.readAsText(s)})(e)}),a.createElement(ot,{text:"DOWNLOAD SYNTH",onClick:()=>(()=>{let t=Object.assign({},e);s.title===e.title&&s.description===e.description||(t=Object.assign(Object.assign({},e),{title:s.title,description:s.description}));let n=[JSON.stringify(t)],a=new File(n,`${t.title}.mConfig`,{type:"text"});const i=document.createElement("a");i.href=URL.createObjectURL(a),i.download=a.name,i.click(),i.remove()})()}))}const Nt=e=>`Your synth file '${e}' could not be uploaded. Please try again.`;function kt(){const e=Le().scaleConfig.tuningFrequency;return a.createElement("div",{className:"flex flex-col"},a.createElement(it,{key:e}),a.createElement(Oe,{animation:me},a.createElement(xt,null)),a.createElement(lt,null))}const wt="CustomScale.scl";function Tt(e){let t=[],n=Ct(e);t.push("! "+n+"\n"),t.push("!\n"),t.push(e.description+"\n"),t.push("  "+e.notes.length+"\n"),t.push("!\n");let a,s=e.notes.slice(1);for(a of s)t.push("  "+a.exportScala()+"\n");return t.push("  "+e.octaveNote.exportScala()),t}function Ct(e){return""===e.title?wt:(function(e){let t=new RegExp(/[A-z0-9]/),n=["-","_"," "];e.endsWith(".scl")&&(e=e.substring(0,e.length-4));for(let a=0;a<e.length;a++)if(!t.test(e[a])){let t;for(t of n){if(e[a]===t)break;if(t===n[n.length-1])throw new Error(jt(e,e[a]))}}if(new RegExp(/^(CON|PRN|AUX|NUL|LST|COM[0-9]|LPT[0-9])$/).test(e))throw new Error(St(e))}(e.title),e.title.endsWith(".scl")?e.title:e.title+".scl")}const jt=(e,t)=>`The scale's title '${e}' contains an invalid character, '${t}'. \n         Only letters, numbers, underscores, and dashes are allowed.\n         \n         Please change the title and try again.\n        `,St=e=>`The scale's title '${e}' is a reserved filename. \n        \n         Please change the title and try again.\n        `;function Rt(){const e=De(),t=Me(),n=Pe(),s=et(),i=s.title,r=s.description,l=tt(),c=()=>{let t=e;i===t.title&&r===t.description||(t=Object.assign(Object.assign({},e),{title:i,description:r}));let a=null;try{a=function(e){let t=Tt(e);return new File(t,Ct(e),{type:"text"})}(t)}catch(e){return void n(e.message)}const s=document.createElement("a");s.href=URL.createObjectURL(a),s.download=a.name,s.click(),s.remove()};return a.createElement("div",{className:"flex flex-col mb-4"},a.createElement(Be,{text:"SCALA FILES"}),a.createElement(ct,{text:"UPLOAD SCALA FILE",accept:".scl",uploadFile:e=>(e=>{let a,s=e.target.files[0],i=new FileReader,r="";i.onload=()=>{a=i.result,r=a instanceof ArrayBuffer?(new TextDecoder).decode(a):a;try{let e=O(r);t({type:ne.SET_SCALE,scale:e}),l({title:e.title,description:e.description})}catch(e){n(e.message)}},i.onerror=()=>{n(At(s.name))},i.readAsText(s)})(e)}),a.createElement(ot,{text:"DOWNLOAD SCALA",onClick:()=>c()}))}const At=e=>`Your scala file '${e}' could not be uploaded. Please try again.`,It="ml-px my-1 p-1.5 touch-none border-2 rounded-md bg-bglight group hover:border-black",_t="w-3 h-3 stroke-2 group-hover:stroke-black";function Lt(e){let t=e.isDragging?"cursor-grabbing border-black":"cursor-grab border-gold",n=e.isDragging?"stroke-black":"stroke-gold";return a.createElement("div",{className:`${It} ${t}`,onPointerDown:t=>e.startDragging(t),onPointerUp:()=>e.setIsDragging(!1)},a.createElement("svg",{className:`${_t} ${n}`,xmlns:"http://www.w3.org/2000/svg",strokeLinecap:"round",strokeLinejoin:"round"},a.createElement("line",{x1:1,y1:1,x2:11,y2:1}),a.createElement("line",{x1:1,y1:6,x2:11,y2:6}),a.createElement("line",{x1:1,y1:11,x2:11,y2:11})))}function Dt(){return a.createElement("div",{className:`${It} border-black`},a.createElement("svg",{className:`${_t} stroke-black`,xmlns:"http://www.w3.org/2000/svg"},a.createElement("line",{x1:1,y1:1,x2:11,y2:1,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("line",{x1:1,y1:6,x2:11,y2:6,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("line",{x1:1,y1:11,x2:11,y2:11,strokeLinecap:"round",strokeLinejoin:"round"})))}function Mt(e){const t=()=>{if(e.isRatio)return e.setBaseNote(g),void e.setIsRatio(!1);e.setBaseNote(f),e.setIsRatio(!0)};return a.createElement("div",{className:"note-converter-container"},e.isRatio?a.createElement("div",{className:"note-converter-box-active note-converter-box-l"},"RATIO"):a.createElement("div",{className:"note-converter-box-inactive note-converter-box-l",onClick:()=>t()},"RATIO"),e.isRatio?a.createElement("div",{className:"note-converter-box-inactive note-converter-box-r",onClick:()=>t()},"CENT"):a.createElement("div",{className:"note-converter-box-active note-converter-box-r"},"CENT"))}function Pt(e){return a.createElement("svg",{className:`${e.className} ${dt} bg-bglight`,xmlns:"http://www.w3.org/2000/svg"},a.createElement("line",{x1:4,y1:4,x2:8,y2:8,strokeLinecap:"round",strokeLinejoin:"round"}),a.createElement("line",{x1:8,y1:4,x2:4,y2:8,strokeLinecap:"round",strokeLinejoin:"round"}))}function Gt(e){const[t,n]=(0,a.useState)(!e.baseNote.num.includes("."));return a.createElement("div",{className:"inline-flex my-1"},a.createElement("div",{className:"relative"},a.createElement(Mt,{isRatio:t,setIsRatio:n,setBaseNote:e.setBaseNote}),a.createElement(Pt,{className:"-top-1.5 -left-1.5"})),a.createElement("input",{className:"settings-panel-input mx-px",type:"string",disabled:!0,value:e.baseNote.num}),a.createElement(Dt,null))}var Ft=n(7609),Vt=n(153),Ut=n(4960);function Kt(e){const[t,n]=(0,a.useState)(e.noteValue),s=(0,a.useRef)(null),[i,r]=a.useState(null);a.useLayoutEffect((()=>{i&&s.current&&([s.current.selectionStart,s.current.selectionEnd]=i)}),[i]);return a.createElement("input",{type:"string",ref:s,value:t,onChange:t=>(t=>{let a=t.target.value,s=[t.target.selectionStart,t.target.selectionEnd],i="",l=!1,c=0;for("-"===a.charAt(0)&&(a.includes("/")||(i+="-",c++,e.setIsRatio(!1)));c<a.length;c++){let t=a.charAt(c);isNaN(parseInt(t))?l||"."!==t&&"/"!==t?s=[s[0]-1,s[1]-1]:(l=!0,i+=t,e.setIsRatio("/"===t)):i+=t}r(s),n(i)})(t),onKeyDown:e=>{var t;"Enter"===(t=e).key&&t.currentTarget.blur()},onBlur:()=>(()=>{let a=k(e.isRatio,t);a!==e.noteValue?e.editNote(a):n(e.noteValue)})(),className:"settings-panel-input mx-px"})}function Bt(e){const t=t=>{"Enter"!==t.key&&" "!==t.key||(e.convertNote(),t.preventDefault())};return a.createElement("div",{className:"note-converter-container"},e.isRatio?a.createElement("div",{className:"note-converter-box-active note-converter-box-l"},"RATIO"):e.note instanceof d&&""===e.note.prevRatio?a.createElement("div",{className:"note-converter-box-inactive-disabled note-converter-box-l"},"RATIO"):a.createElement("div",{className:"note-converter-box-inactive note-converter-box-l",tabIndex:0,onClick:()=>e.convertNote(),onKeyDown:t},"RATIO"),e.isRatio?a.createElement("div",{className:"note-converter-box-inactive note-converter-box-r",tabIndex:0,onClick:()=>e.convertNote(),onKeyDown:t},"CENT"):a.createElement("div",{className:"note-converter-box-active note-converter-box-r"},"CENT"))}function $t(e){const t=Me(),[n,s]=(0,a.useState)(!e.note.num.includes("."));return a.createElement("div",{className:"inline-flex"},a.createElement("div",{className:"relative"},a.createElement(Bt,{note:e.note,isRatio:n,convertNote:()=>{t({type:ne.CONVERT_NOTE,noteIndex:e.noteIndex})}}),a.createElement(mt,{className:"-top-1.5 -left-1.5",onClick:()=>{t({type:ne.DELETE_NOTE,noteIndex:e.noteIndex})}})),a.createElement(Kt,{noteValue:e.note.num,isRatio:n,setIsRatio:s,editNote:n=>{t({type:ne.EDIT_NOTE,noteValue:n,noteIndex:e.noteIndex})}}))}function qt(e){const[t,n]=(0,a.useState)(!1),s=(0,Vt.o)(),i=(0,Ut.c)(0);return a.createElement(Ft.t.Item,{value:e.note,style:{y:i},dragListener:!1,dragControls:s,dragConstraints:e.listRef,onDragEnd:()=>(n(!1),void e.reorderScale()),className:"inline-flex relative select-none my-1 "+(t?"z-10":"z-0")},a.createElement($t,{note:e.note,noteIndex:e.noteIndex}),a.createElement(Lt,{isDragging:t,setIsDragging:n,startDragging:e=>{n(!0),s.start(e)}}))}function Yt(e){const t=De(),n=Me(),[s,i]=(0,a.useState)(t.notes.slice(1)),r=(0,a.useRef)(null);(0,a.useEffect)((()=>{i(t.notes.slice(1))}),[t]);const l=()=>{if(c())return;let a=Object.assign(Object.assign({},t),{notes:[e.baseNote,...s]});n({type:ne.SET_SCALE,scale:a})},c=()=>{let e=t.notes.slice(1);for(let t=0;t<s.length;t++)if(s.at(t).id!==e.at(t).id)return!1;return!0};return a.createElement(Ft.t.Group,{className:"select-none",axis:"y",layoutScroll:!0,ref:r,values:s,onReorder:i},s.map(((e,t)=>a.createElement(qt,{key:e.id,note:e,noteIndex:t+1,listRef:r,reorderScale:l}))))}function Wt(){const e=De().octaveNote,t=Me(),[n,s]=(0,a.useState)(!e.num.includes("."));return a.createElement("div",{className:"inline-flex"},a.createElement("div",{className:"relative"},a.createElement(Bt,{note:e,isRatio:n,convertNote:()=>{t({type:ne.CONVERT_OCTAVE_NOTE})}}),a.createElement(Pt,{className:"-top-1.5 -left-1.5"})),a.createElement(Kt,{noteValue:e.num,isRatio:n,setIsRatio:s,editNote:e=>{t({type:ne.EDIT_OCTAVE_NOTE,noteValue:e})}}),a.createElement(Dt,null))}function zt(){const e=nt(),t=(0,a.useContext)(Je),n=e===ze.VISUAL?Et.pencilSquare:Et.listBullet;return a.createElement(ht,{className:"ml-px",svg:n,onClick:()=>{t((e=>e===ze.VISUAL?ze.SCALA:ze.VISUAL))}})}function Ht(e){const t=et(),n=tt(),s=ut(e.setVisible,!1);return a.createElement(Oe,{className:"absolute w-full p-1 bg-neutral-700 border-2 border-black rounded",clickOutsideRef:s,animation:fe,visible:e.visible},a.createElement(gt,{title:"Scale Name",filename:t.title,setFilename:e=>{n(Object.assign(Object.assign({},t),{title:e}))}}),a.createElement(ft,{className:"mt-1",title:"Scale Description",description:t.description,setDescription:e=>{n(Object.assign(Object.assign({},t),{description:e}))}}),a.createElement(mt,{className:"-top-1.5 -right-1.5",onClick:()=>{e.setVisible(!1)}}))}function Jt(){const e=De(),t=Me(),[n,s]=(0,a.useState)(e.notes.length<=1?e.octaveNote instanceof p?f:g:e.notes.at(1)instanceof p?f:g),[i,r]=(0,a.useState)(!1);return a.createElement("div",{className:"flex flex-col"},a.createElement("div",{className:"flex justify-between relative z-10"},a.createElement(Oe,{animation:me},a.createElement(Be,{className:"mb-1",text:"SCALE EDITOR"})),a.createElement("div",{className:"flex flex-row"},a.createElement(ht,{svg:Et.cog6tooth,onClick:()=>{r((e=>!e))}}),a.createElement(zt,null)),a.createElement(Ht,{visible:i,setVisible:r})),a.createElement(Oe,{className:"w-full h-full flex flex-col",animation:Object.assign(Object.assign({},pe),{transition:{duration:.4}})},a.createElement(ot,{text:"ADD NOTE",className:"animate-none",onClick:()=>{let a,s=e.notes;a=1===s.length?D(n,e.octaveNote):D(s[s.length-1],e.octaveNote),t({type:ne.ADD_NOTE,note:a})}}),a.createElement("div",{className:"mt-1.5"},a.createElement(Gt,{baseNote:n,setBaseNote:s}),a.createElement(Yt,{baseNote:n}),a.createElement("div",{className:"mt-1"},a.createElement(Be,{text:"OCTAVE NOTE"}),a.createElement(Wt,{key:e.octaveNote.id})))))}function Zt(e){const t=e.original===e.current;return a.createElement(ht,{svg:Et.arrowDownTray,onClick:e.onClick,disabled:t},!t&&a.createElement("div",{className:"absolute animate-scale-in -top-1.5 -left-1.5 w-3 h-3 rounded-full bg-gold dark:bg-black border border-black dark:border-gold"}))}function Qt(){const e=De(),t=Me(),n=Pe(),s=et(),i=tt(),r=()=>{let t=e;return t.title===s.title&&t.description===s.description||(t=Object.assign(Object.assign({},t),{title:s.title,description:s.description})),Tt(t)},l=r(),[c,o]=(0,a.useState)(l),u="settings-panel-input resize-none "+(he.vU?"whitespace-pre overflow-x-scroll":"whitespace-nowrap overflow-x-auto"),m=c.length,d=window.innerWidth;(0,a.useEffect)((()=>{o(r())}),[e,s]);const g=()=>{const e=document.createElement("a");e.href="https://huygens-fokker.org/scala/scl_format.html",e.target="_blank",e.click(),e.remove()};return a.createElement("div",{className:"flex flex-col"},a.createElement("div",{className:"flex justify-between"},a.createElement(Oe,{className:"flex flex-row",animation:me},a.createElement(Be,{className:"mb-1",text:"SCALA EDITOR"})),a.createElement("div",{className:"flex flex-row"},a.createElement(Zt,{original:l.join(""),current:c.join(""),onClick:()=>{let a;try{a=O(c.join(""))}catch(e){return void n(e.message)}E(a,e)?o(l):(i(Object.assign(Object.assign({},s),{title:a.title,description:a.description})),t({type:ne.SET_SCALE,scale:a}))}}),a.createElement(zt,null))),a.createElement(Oe,{className:"relative",animation:pe},a.createElement("textarea",{className:u,rows:m,cols:d,value:c.join(""),onChange:e=>(e=>{let t=e.target.value.split("\n");t=t.map(((e,n)=>n===t.length-1?e:e+"\n")),o(t)})(e)}),a.createElement("div",{className:"absolute top-1 right-1 h-min group cursor-pointer bg-neutral-200 dark:bg-bgdark outline-0",tabIndex:0,onClick:()=>g(),onKeyDown:e=>{var t;"Enter"!==(t=e).key&&" "!==t.key||(g(),t.preventDefault())},onMouseLeave:e=>e.currentTarget.blur()},a.createElement("svg",{className:"w-6 h-6 fill-none stroke-2 stroke-neutral-400 dark:stroke-black group-hocus:stroke-black dark:group-hocus:stroke-gold",xmlns:"http://www.w3.org/2000/svg",strokeLinecap:"round",strokeLinejoin:"round"},vt(Et.questionMarkCircle)))))}function Xt(){const e=nt();return a.createElement(a.Fragment,null,e===ze.VISUAL?a.createElement(Jt,null):a.createElement(Qt,null))}function en(){const e=Le().scaleConfig.tuningFrequency;return a.createElement("div",{className:"flex flex-col"},a.createElement(it,{key:e}),a.createElement(Oe,{animation:me},a.createElement(Rt,null)),a.createElement(Xt,null))}function tn(e){return a.createElement("div",{className:"my-1.5 px-2 rounded-2xl overflow-y-auto"},e.currentTab===at.BASIC&&a.createElement(kt,null),e.currentTab===at.SCALE&&a.createElement(en,null))}function nn(){const[e,t]=(0,a.useState)(at.BASIC);return a.createElement("div",{className:"flex flex-col w-full h-full border-t-2 border-r-2 border-gold rounded-tr-xl bg-bglight"},a.createElement("div",{className:"pt-3 pb-2 text-center"},a.createElement(Be,{text:"SETTINGS"})),a.createElement(st,{currentTab:e,setCurrentTab:t}),a.createElement(tn,{currentTab:e}))}var an=n(3750);function sn(e){const t=Math.floor(e.divWidth/40)-1;return a.createElement(an.Z,{describeChild:!0,placement:"top",title:e.frequency},a.createElement("button",{"aria-describedby":"simple-popover",className:"btn w-10 max-w-10 items-center justify-center p-0 font-agrandir text-black  border-b-2 border-r-2 border-black text-sm "+(e.active?"bg-gold":"bg-neutral-200 hover:bg-neutral-300")+" "+(0===e.index||e.index===t+1||e.index===2*t+2?"rounded-l-md":"")+" "+(e.index===e.length||e.index===t||e.index===2*t+1?"rounded-r-md":"")+" ",onClick:t=>e.onClick(e.isEditing?null:e.scaleDegree)},Math.round(e.frequency),a.createElement("div",{className:e.active||e.isEditing?"":"opacity-0"},e.isEditing?"???":e.keyMapping)))}const rn=e=>{let t={};for(let n in e)t[e[n]]=Number(n);return t},ln=(e,t)=>{for(;e<0;)e+=t;return e%t},cn=(e,t,n,a,s)=>{let i=e[t];return void 0===i?null:ln(i-n,s)};var on=function(e){const t=Le().scaleConfig,n=(0,a.useRef)(null),[s,i]=(0,a.useState)(null);let r;function l(){const e=n.current;clearTimeout(r),r=setTimeout((()=>{i(e.offsetWidth-44)}),1)}(0,a.useEffect)((()=>(null===s&&l(),window.addEventListener("resize",l),()=>window.removeEventListener("resize",l))),[s]);const[c,o]=(0,a.useState)(null);let u=[],m=rn(e.keyMapping);(0,a.useEffect)((()=>{if(null===c)return;const n=a=>{if(null!==c){let s=-1;for(let t=0;t<e.keyboardShortcuts.length;t++){if(e.keyboardShortcuts[t].key===a.key.toLowerCase()){s=t;break}}if(-1===s)return o(null),void document.removeEventListener("keydown",n);let i=cn(m,c,e.keyOffset,t.scale.notes.length,t.keysPerOctave),r=ln(s+e.keyOffset,t.keysPerOctave);if(null!==i){let n=ln(i+e.keyOffset,t.keysPerOctave);console.log(`Unsetting scaleDegree ${c} bound to ${i} ${e.keyboardShortcuts[i].key} which is key mapping ${n}`),e.mcDispatch({type:ne.UNSET_KEYBIND,keyIndex:n})}console.log(i,r),e.mcDispatch({type:ne.SET_KEYBIND,keyIndex:r,scaleDegree:c}),o(null),document.removeEventListener("keydown",n)}};return document.addEventListener("keydown",n),()=>document.removeEventListener("keydown",n)}),[c]);let d=null;for(let n=0;n<t.scale.notes.length;n++)if(void 0!==e.keyMapping[e.keyOffset+n]){d=e.keyMapping[e.keyOffset+n];break}for(let n=0;n<t.scale.notes.length;n++){let i,r=(n+d)%t.scale.notes.length,l=Math.floor((n+d)/t.scale.notes.length),g=m[r],p=cn(m,r,e.keyOffset,t.scale.notes.length,t.keysPerOctave);if(null===p)i="None";else try{i=e.keyboardShortcuts[p].key.toUpperCase()}catch(e){i="None",g=void 0}u.push(a.createElement(sn,{frequency:e.midiReceiver.ScaleDegreeToFrequency(r,e.octaveOffset+l),keyMapping:i,key:r,active:void 0!==g,isEditing:c===r,scaleDegree:r,onClick:o,index:n,length:t.scale.notes.length-1,divWidth:s}))}return a.createElement("div",{ref:n,className:"w-full flex justify-center mt-10 items-center"},a.createElement("div",{className:"flex flex-row justify-center flex-wrap"},u),a.createElement(an.Z,{describeChild:!0,title:"Click a box on the frequency bar, then press the desired key on your keyboard in order to bind it to the desired frequency."},a.createElement("button",{className:"btn min-w-[1.75rem] w-7 aspect-square bg-white dark:bg-bgdark text-black dark:text-gold rounded-full mx-2 dark:border-2 dark:border-gold"},"?")))};function un(e){return a.createElement("div",{className:`border-4 border-black bg-piano-edge dark:bg-bgdark\n    ${e.faceUp?"rounded-t-3xl border-b-0 pt-2":"rounded-b-3xl pb-2"} ${e.className}`,onClick:e.onClick,onKeyDown:e=>{"Enter"!==e.key&&" "!==e.key||(e.currentTarget.click(),e.preventDefault())},tabIndex:0,role:"button","aria-pressed":"false"},a.createElement("div",{className:`w-full h-full \n        ${e.faceUp?"rounded-t-3xl":"rounded-b-3xl"} \n        p-2 bg-piano-surface flex items-center justify-center dark:bg-bglight`},e.children))}function mn(e){return a.createElement("div",{className:`flex flex-col h-full ${e.className}`},a.createElement("span",{className:"text-white text-center font-agrandir-wide"},"OCTAVE"),a.createElement(un,{faceUp:!0,className:"lg:w-24 w-16 h-1/2",onClick:()=>e.octaveUp()},a.createElement("svg",{className:"fill-neutral-700 dark:fill-gold",width:"33",height:"33",viewBox:"0 0 33 33",xmlns:"http://www.w3.org/2000/svg"},a.createElement("g",{clipPath:"url(#clip0_316_24360)"},a.createElement("path",{d:"M16.5954 11.4768L24.6515 19.5329H8.53931L16.5954 11.4768Z"})),a.createElement("defs",null,a.createElement("clipPath",{id:"clip0_316_24360"},a.createElement("rect",{width:"32.2244",height:"32.2244",fill:"white",transform:"translate(0.483154 0.735352)"}))))),a.createElement(un,{className:"lg:w-24 w-16 h-1/2",onClick:()=>e.octaveDown()},a.createElement("svg",{className:"fill-neutral-700 dark:fill-gold",width:"17",height:"9",viewBox:"0 0 17 9",xmlns:"http://www.w3.org/2000/svg"},a.createElement("path",{d:"M8.59542 8.2085L16.6515 0.152384H0.539307L8.59542 8.2085Z"}))))}const dn=60,gn="#a3a3a3",pn="#171717",fn="#60a5fa";function bn(e){const t=Le().scaleConfig;return a.createElement(a.Fragment,null,a.createElement("style",{dangerouslySetInnerHTML:{__html:`\n          .ReactPiano__Keyboard > div.ReactPiano__Key--accidental:nth-child(n+${t.keysPerOctave+1}) {\n            background: ${pn};\n          }\n          .ReactPiano__Keyboard > div.ReactPiano__Key--natural:nth-child(n+${t.keysPerOctave+1}) {\n            background: ${gn};\n          }\n          .ReactPiano__Keyboard > div.ReactPiano__Key--active:nth-child(n+${t.keysPerOctave+1}) {\n            background: ${fn};\n          }\n        `}}),a.createElement("div",{className:"w-2/3"},a.createElement(I.id,{noteRange:{first:e.rootKey+e.keyOffset,last:e.rootKey+e.keyOffset+e.keyboardLength},playNote:t=>{e.midiReceiver.noteOn(t,dn)},stopNote:t=>{e.midiReceiver.noteOff(t)},keyboardShortcuts:e.keyboardShortcuts})))}var hn;!function(e){e[e.INCREASE_OCTAVE=0]="INCREASE_OCTAVE",e[e.DECREASE_OCTAVE=1]="DECREASE_OCTAVE",e[e.SET_MICROTONAL_CONFIG=2]="SET_MICROTONAL_CONFIG"}(hn||(hn={}));const En={minimumKeyboardLength:14,maximumKeyboardLength:14},vn=21,yn=127;function On(e,t,n,a,s){let i=t+e*n+a;return[i,i+s]}function xn(e){return Math.min(Math.max(En.minimumKeyboardLength,e),En.maximumKeyboardLength)}function Nn(e,t){let n=e.octave,a=e.userKeyOffset,s=e.rootKey,i=e.keysPerOctave;switch(t.type){case hn.INCREASE_OCTAVE:n+=1;break;case hn.DECREASE_OCTAVE:n-=1;break;case hn.SET_MICROTONAL_CONFIG:s=t.config.scaleConfig.rootKey,i=t.config.scaleConfig.keysPerOctave}let r=xn(i),[l,c]=On(i,s,n,a,r);l<=vn-i&&(n+=1),c>=yn+i&&(n-=1),[l,c]=On(i,s,n,a,r);let o=0;return l<vn&&(o+=vn-l),c>yn&&(r-=c-yn),{octave:n,keyOffset:a+o,rootKey:s,keysPerOctave:i,userKeyOffset:a,keyboardLength:r}}function kn(e){const t=Le(),n=Me(),[s,i]=(0,a.useReducer)(Nn,{octave:0,keyOffset:0,keysPerOctave:(r=t).scaleConfig.keysPerOctave,rootKey:r.scaleConfig.rootKey,userKeyOffset:0,keyboardLength:xn(r.scaleConfig.keysPerOctave)});var r;(0,a.useEffect)((()=>{i({type:hn.SET_MICROTONAL_CONFIG,config:t})}),[t]);const l=()=>L(t.scaleConfig.rootKey+s.keyOffset+s.octave*t.scaleConfig.keysPerOctave,s.keyboardLength);let[c,u]=(0,a.useState)(l());(0,a.useEffect)((()=>{u(l())}),[t,s]);return a.createElement("div",{className:"flex flex-col justify-center h-full border-gold border-t-2 border-l-2 border-b-2 rounded-tl-xl rounded-bl-xl bg-bglight"},a.createElement("div",{className:"flex justify-center"},a.createElement(on,{keyMapping:e.keyMapping,keyboardShortcuts:c,playMidiNote:()=>{},midiReceiver:e.midiReceiver,keyOffset:s.keyOffset,setKeyMapping:e.setKeyMapping,octaveOffset:s.octave,mcDispatch:n})),a.createElement("div",{className:"flex flex-row justify-around w-full mt-1 flex-1 py-2"},a.createElement("div",{className:"w-32"},a.createElement(o,{knobLabel:"GAIN",value:t.synthConfig.gain,onChange:e=>(e=>{n({type:ne.SET_MASTER_GAIN,gain:e})})(e),className:"border-gold border-[3px]"})),a.createElement(bn,{keyboardShortcuts:c,keyMapping:e.keyMapping,keyOffset:s.keyOffset,midiReceiver:e.midiReceiver,rootKey:t.scaleConfig.rootKey+s.octave*t.scaleConfig.keysPerOctave,keyboardLength:s.keyboardLength}),a.createElement(mn,{className:"pr-6",octaveUp:()=>i({type:hn.INCREASE_OCTAVE}),octaveDown:()=>i({type:hn.DECREASE_OCTAVE})})))}class wn{constructor(e){this.midiInput=[],this.midiOutput=[],this.config=we,this.keyMapping=Te.keyMapping,this.synth=e,this.connectToInstrument()}connectToInstrument(){navigator.requestMIDIAccess&&navigator.requestMIDIAccess().then((e=>{this.initDevices(e),e.onstatechange=t=>{this.initDevices(e)}}),(e=>console.warn("unable to connect to midi",e)))}initDevices(e){this.midiInput=[],this.midiOutput=[];for(let t of e.inputs.values())this.midiInput.push(t),t.onmidimessage=this.onMIDIMessage.bind(this);for(let t of e.outputs.values())this.midiOutput.push(t)}onMIDIMessage(e){let t=e.data[0];if(t==wn.NOTE_ON_MESSAGE){let t=e.data[1],n=e.data[2];this.noteOn(t,n)}else if(t==wn.NOTE_OFF_MESSAGE){let t=e.data[1];this.noteOff(t)}else if(t==wn.PITCH_BEND_MESSAGE){e.data[1],e.data[2]}else console.warn("This MIDI Input is not supported yet!")}noteOn(e,t){if(null==e||e<0||isNaN(e))return void console.warn("Invalid note received!");let n=this.MidiNotesToFrequency(e);this.synth.onPlayFrequency(n,t)}noteOff(e){if(null==e||e<0||isNaN(e))return void console.warn("Invalid note received!");let t=this.MidiNotesToFrequency(e);this.synth.onStopFrequency(t)}MidiNotesToFrequency(e){let t=(e-this.config.rootKey)%this.config.keysPerOctave;for(;t<0;)t+=this.config.keysPerOctave;let n,a,s,i=Math.floor((e-this.config.rootKey)/this.config.keysPerOctave);try{a=this.keyMapping[t],s=v(this.config.scale,a),n=s.multiplier}catch(n){return console.log(`Error: key in octave ${t} (MIDI number: ${e}) is not assigned to a note in the scale.`),null}return this.ScaleDegreeToFrequency(a,i)}ScaleDegreeToFrequency(e,t){let n=v(this.config.scale,e).multiplier;return this.config.tuningFrequency*n*Math.pow(this.config.scale.octaveNote.multiplier,t)}}wn.NOTE_ON_MESSAGE=144,wn.NOTE_OFF_MESSAGE=128,wn.PITCH_BEND_MESSAGE=224;var Tn=function(e,t,n,a){return new(n||(n=Promise))((function(s,i){function r(e){try{c(a.next(e))}catch(e){i(e)}}function l(e){try{c(a.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,l)}c((a=a.apply(e,t||[])).next())}))};class Cn{constructor(e,t,n,a,s){this.oscillatorNodes=[],this.gainNodes=[],this.endingPlay=!1,this.stopped=!1;for(let n=0;n<e.length;n++)this.oscillatorNodes[n]=a.createOscillator(),this.oscillatorNodes[n].frequency.setValueAtTime(e[n].pitchRatio*t,a.currentTime),this.oscillatorNodes[n].type=e[n].waveType,this.gainNodes[n]=a.createGain(),this.gainNodes[n].gain.value=0,this.oscillatorNodes[n].connect(this.gainNodes[n]),this.gainNodes[n].connect(s)}beginPlay(e,t){return Tn(this,void 0,void 0,(function*(){for(let n=0;n<this.oscillatorNodes.length;n++)this.oscillatorNodes[n].start(0),this.gainNodes[n].gain.setValueAtTime(0,0),this.gainNodes[n].gain.linearRampToValueAtTime(t.oscillators[n].localGain,e.currentTime+t.attack);if(yield new Promise((e=>setTimeout(e,1001*t.attack))),!this.endingPlay)for(let n=0;n<this.oscillatorNodes.length;n++)this.gainNodes[n].gain.linearRampToValueAtTime(t.sustain*t.oscillators[n].localGain,e.currentTime+t.decay)}))}endPlay(e,t){return Tn(this,void 0,void 0,(function*(){this.endingPlay=!0,this.gainNodes.forEach((function(n){n.gain.linearRampToValueAtTime(n.gain.value,e.currentTime+.001),n.gain.linearRampToValueAtTime(1e-4,e.currentTime+t)})),yield new Promise((e=>setTimeout(e,1e3*t))),this.stopped=!0,this.oscillatorNodes.forEach((function(e){e.stop(1)}))}))}}const jn=new class{constructor(){this.config=ke,this.audioContext=new AudioContext,this.masterGain=this.audioContext.createGain(),this.dynamicsCompressor=this.audioContext.createDynamicsCompressor(),this.oscillatorStacks={},this.dynamicsCompressor.connect(this.masterGain),this.masterGain.connect(this.audioContext.destination)}updateSettings(){this.masterGain.gain.value=this.config.gain,this.clearOscillators()}clearOscillators(){for(let e in this.oscillatorStacks)this.oscillatorStacks[e].endPlay(this.audioContext,this.config.release),delete this.oscillatorStacks[e]}onPlayFrequency(e,t){null==this.oscillatorStacks[e]&&(this.oscillatorStacks[e]=new Cn(this.config.oscillators,e,this.config.gain,this.audioContext,this.dynamicsCompressor),this.oscillatorStacks[e].beginPlay(this.audioContext,this.config))}onStopFrequency(e){null!=this.oscillatorStacks[e]&&(this.oscillatorStacks[e].endPlay(this.audioContext,this.config.release),delete this.oscillatorStacks[e])}},Sn=new wn(jn);function Rn(){const e=_e(),t=Le(),n=Me();(0,a.useEffect)((()=>{Sn.config=t.scaleConfig,Sn.keyMapping=t.keyMapping,jn.config=t.synthConfig,jn.updateSettings()}),[t]);return a.createElement("div",{className:"flex flex-1 w-full h-full mt-1 overflow-auto"},a.createElement(Ne,null),a.createElement("div",{className:"max-w-xs 2xl:max-w-md"},a.createElement(Ze,null,a.createElement(nn,null))),a.createElement("div",{className:"flex flex-col w-full ml-1"},a.createElement("div",{className:"absolute flex-row ml-3 mt-3"},a.createElement(ot,{className:"mr-1",text:"UNDO",disabled:0===e.previous.length,onClick:()=>{n({type:ne.UNDO_CONFIG})}}),a.createElement(ot,{text:"REDO",disabled:0===e.next.length,onClick:()=>{n({type:ne.REDO_CONFIG})}})),a.createElement("div",{className:"h-1/2 flex-row mb-1"},a.createElement(kn,{keyMapping:e.current.keyMapping,midiReceiver:Sn,setKeyMapping:()=>{}})),a.createElement("div",{className:"h-1/2 flex-row"},a.createElement(Ke,null))))}function An(e){return a.createElement("div",{className:`${e.className} border-gold border-2 rounded-xl bg-bglight`},e.children)}function In(){return a.createElement("div",{className:"w-full p-10"},a.createElement(An,{className:"flex justify-center px-8 py-8 text-left text-base"},a.createElement("article",{className:"prose prose-white prose-invert"},"This project works on multiple fronts to bring microtonal works to life. As a starting point, Easley Blackwood's microtonal etudes provide a number of difficulties to overcome in order to produce a full performance. You can read about the ideas to tackle these challenges in the paper below.",a.createElement("br",null),a.createElement("br",null),"Richard Leinecker and William R. Ayers, “Performing Easley Blackwood's",a.createElement("a",{className:"italic ..."}," Twelve Microtonal Etudes"),": An Open-Source Software Development Project,” in",a.createElement("a",{className:"italic ..."}," Mathematics and Computation in Music 2022"),", edited by Mariana Montiel, Octavio A. Agustín-Aquino, Francisco Gómez, Jeremy Kastine, Emilio Lluis-Puebla, and Brent Milam (2022): 331-339. Springer Nature.",a.createElement("br",null),a.createElement("a",{href:"https://doi.org/10.1007/978-3-031-07015-0_27",className:"font-medium text-blue-600 underline dark:text-blue-500 hover:no-underline"},"https://doi.org/10.1007/978-3-031-07015-0_27"))),a.createElement("br",null),a.createElement("br",null),a.createElement(An,{className:"flex justify-center px-8 py-8 text-left text-base"},a.createElement("article",{className:"prose prose-white prose-invert"},"The microtonal synthesizer available on the Download page was produced by Computer Science majors completing their Senior Design Projects at the University of Central Florida (listed below). The synthesizer (created using the JUCE framework) includes tone generators, ADSR envelope controls, microtonal scale generation and keyboard mapping functionality, and components for saving mappings and instruments.",a.createElement("br",null),a.createElement("br",null),"Version 1.0.0 (2022)",a.createElement("br",null),"Jake DiClemente",a.createElement("br",null),"Isaiah Kovacich",a.createElement("br",null),"Anthony Moore",a.createElement("br",null),"Michael Ortiz",a.createElement("br",null),"John Pham")),a.createElement("br",null),a.createElement("br",null),a.createElement(An,{className:"flex justify-center px-8 py-8 text-left text-base"},a.createElement("article",{className:"prose prose-white prose-invert"},"The browser application on the Play page was produced by Computer Science majors completing their Senior Design Projects at the University of Central Florida (listed below).",a.createElement("br",null),a.createElement("br",null),"Calvin Agar",a.createElement("br",null),"Peter Devita",a.createElement("br",null),"Noah Hartley",a.createElement("br",null),"Zachary Hasley",a.createElement("br",null),"Nathan Manierre",a.createElement("br",null),"Austin Smith")),a.createElement("br",null),a.createElement("br",null),a.createElement(An,{className:"flex justify-center px-8 py-8 text-left text-base"},a.createElement("article",{className:"prose prose-white prose-invert"},"This project also engages students in the School of Performing Arts at the University of Central Florida (listed below). Music students work on notation projects to convert microtonal notation into easily readable, comprehensible, and gesturally practicable notation for the purpose of performance on the microtonal synthesizer using a standard keyboard controller.",a.createElement("br",null),a.createElement("br",null),"Michael Crisafi")))}function _n(){return a.createElement("div",{className:"w-full p-10"},a.createElement(An,{className:"flex justify-center px-8 py-8 text-left text-base"},a.createElement("article",{className:"prose prose-white prose-invert"},"The most recent release of the desktop synthesizer and the source code for both the desktop and browser synthesizer projects can be found at the link below.",a.createElement("br",null),a.createElement("br",null),a.createElement("a",{href:"https://github.com/microtonality",className:"font-medium text-blue-600 underline dark:text-blue-500 hover:no-underline"},"https://github.com/microtonality"))))}function Ln(){return a.createElement("div",{className:"w-full p-10"},a.createElement(An,{className:"flex justify-center px-8 py-8 text-left text-base"},a.createElement("article",{className:"prose prose-white prose-invert"},"If you have any questions or suggestions about the project, please feel free to contact us through the email addresses below.",a.createElement("br",null),a.createElement("br",null),"Dr. Ayers:",a.createElement("br",null),"William.Ayers@ucf.edu",a.createElement("br",null),a.createElement("br",null),"Dr. Leinecker:",a.createElement("br",null),"Richard.Leinecker@ucf.edu")))}function Dn(){return a.createElement("div",{className:"w-full p-10"},a.createElement(An,{className:"flex justify-center px-8 py-8 text-left text-base"},a.createElement("article",{className:"prose prose-white prose-invert"},"This open-source development project is dedicated to the performance of microtonal music. The project incorporates multiple elements to this effect, including a standalone desktop software synthesizer and a browser application that allow microtonal playback. This project began as an effort to fulfill Easley Blackwood's wish to hear a live performance of his Twelve Microtonal Etudes (1980), but the project also has the potential to inspire performances of other existing microtonal works and the creation of new works. On this website, you can learn about the project, its elements, and the team members under the Learn tab, you can test out some elements of microtonality in your browser under the Play tab, and you can access the source code to different elements of the project, including the desktop and browser applications under the Download tab. Feel free to get in touch with us if you have any issues or inquiries. Our information can be found under the Contact tab.",a.createElement("br",null),"Richard Leinecker and William R. Ayers, University of Central Florida")))}const Mn=()=>a.createElement(a.Fragment,null,a.createElement("nav",{className:"relative flex flex-wrap items-center justify-between px-2 2xl:py-7 xl:py-6 lg:py-5 md:py-4 sm:py-3 xs:py-2 bg-bglight border-b-2 border-gold"},a.createElement("span",{className:"2xl:text-xl xl:text-lg lg:text-md md:text-sm sm:text-xs xs:text-xs font-agrandir-wide leading-relaxed inline-block mr-4 px-5 whitespace-nowrap uppercase text-white"},"MICROTONAL SYNTHESIZER PROJECT"),a.createElement("span",{className:"2xl:mr-10 xl:mr-9 lg:mr-8 md:mr-7 sm:mr-6 xs:mr-5"},a.createElement(l,{to:"/learn",end:!0},a.createElement("div",{className:"hover:underline"},"LEARN")),a.createElement(l,{to:"/play"},a.createElement("div",{className:"hover:underline"},"PLAY")),a.createElement(l,{to:"/download"},a.createElement("div",{className:"hover:underline"},"DOWNLOAD")),a.createElement(l,{to:"/contact"},a.createElement("div",{className:"hover:underline"},"CONTACT")))),a.createElement(r.j3,null));var Pn=e=>{e&&e instanceof Function&&n.e(736).then(n.bind(n,2131)).then((({getCLS:t,getFID:n,getFCP:a,getLCP:s,getTTFB:i})=>{t(e),n(e),a(e),s(e),i(e)}))};s.s(document.getElementById("root")).render(a.createElement(a.StrictMode,null,a.createElement((function(){return a.createElement(Ie,null,a.createElement(i.UT,null,a.createElement(r.Z5,null,a.createElement(r.AW,{path:"/",element:a.createElement(Mn,null)},a.createElement(r.AW,{index:!0,element:a.createElement(Dn,null)}),a.createElement(r.AW,{path:"learn",element:a.createElement(In,null)}),a.createElement(r.AW,{path:"play",element:a.createElement(Rn,null)}),a.createElement(r.AW,{path:"download",element:a.createElement(_n,null)}),a.createElement(r.AW,{path:"contact",element:a.createElement(Ln,null)})))))}),null))),Pn()}},s={};function i(e){var t=s[e];if(void 0!==t)return t.exports;var n=s[e]={exports:{}};return a[e].call(n.exports,n,n.exports,i),n.exports}i.m=a,i.amdO={},e=[],i.O=function(t,n,a,s){if(!n){var r=1/0;for(u=0;u<e.length;u++){n=e[u][0],a=e[u][1],s=e[u][2];for(var l=!0,c=0;c<n.length;c++)(!1&s||r>=s)&&Object.keys(i.O).every((function(e){return i.O[e](n[c])}))?n.splice(c--,1):(l=!1,s<r&&(r=s));if(l){e.splice(u--,1);var o=a();void 0!==o&&(t=o)}}return t}s=s||0;for(var u=e.length;u>0&&e[u-1][2]>s;u--)e[u]=e[u-1];e[u]=[n,a,s]},i.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return i.d(t,{a:t}),t},n=Object.getPrototypeOf?function(e){return Object.getPrototypeOf(e)}:function(e){return e.__proto__},i.t=function(e,a){if(1&a&&(e=this(e)),8&a)return e;if("object"==typeof e&&e){if(4&a&&e.__esModule)return e;if(16&a&&"function"==typeof e.then)return e}var s=Object.create(null);i.r(s);var r={};t=t||[null,n({}),n([]),n(n)];for(var l=2&a&&e;"object"==typeof l&&!~t.indexOf(l);l=n(l))Object.getOwnPropertyNames(l).forEach((function(t){r[t]=function(){return e[t]}}));return r.default=function(){return e},i.d(s,r),s},i.d=function(e,t){for(var n in t)i.o(t,n)&&!i.o(e,n)&&Object.defineProperty(e,n,{enumerable:!0,get:t[n]})},i.e=function(){return Promise.resolve()},i.g=function(){if("object"==typeof globalThis)return globalThis;try{return this||new Function("return this")()}catch(e){if("object"==typeof window)return window}}(),i.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},i.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},function(){var e={179:0};i.O.j=function(t){return 0===e[t]};var t=function(t,n){var a,s,r=n[0],l=n[1],c=n[2],o=0;if(r.some((function(t){return 0!==e[t]}))){for(a in l)i.o(l,a)&&(i.m[a]=l[a]);if(c)var u=c(i)}for(t&&t(n);o<r.length;o++)s=r[o],i.o(e,s)&&e[s]&&e[s][0](),e[s]=0;return i.O(u)},n=self.webpackChunkMicrotonality=self.webpackChunkMicrotonality||[];n.forEach(t.bind(null,0)),n.push=t.bind(null,n.push.bind(n))}();var r=i.O(void 0,[736],(function(){return i(8105)}));r=i.O(r)}();
//# sourceMappingURL=main.6c820eb1d2618e93616a.js.map